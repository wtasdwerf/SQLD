## 식별자

엔터티 내에서 인스턴스를 구분하는 구분자

식별자는 논리적 / key는 물리적 데이터 모델링 단계에 사용 

## 식별자 특징

유일성 = 주 식별자에 의해 모든 인스턴스들이 유일하게 구분

희소성 = 주 식별자를 구성하는 속성의 수는 유일성을 만족하는 최소의 수가 되어야 함

불변성 = 지정된 주 식별자의 값은 자주 변하지 않아야 함. 변하면 이전 기록 말소됨

존재성 = 주 식별자가 지정되면 반드시 값이 들어와야 함

## 식별자 분류

### 대표성 여부

주 식별자 / 보조 식별자

주 식별자 

엔터티 내에서 각 어커런스를 구분할 수 있는 구분자

타 엔터티와 참조 관계를 연결함

보조 식별자

구분자이나 대표성 없음

참조관계 연결 안함

### 스스로 생성 여부

내부 식별자 = 스스로 생성되는 식별자

외부 식별자 = 타 엔터티로부터 받아오는 식별자


### 속성의 수

단일 식별자 / 복합 식별자

단일 = 하나의 속성

복함 = 2개 이상

### 대체 여부 

본질 식별자 / 인조 식별자

본질 = 업무에 의해 만들어지는 식별자

인조 = 인위적으로 만든 식별자

## 주 식별자 도출 기준

1. 해당 업무에서 자주 이용되는 속성

2. 명칭, 내역 등과 같이 이름으로 기술되는 것들은 X

3. 복합으로 주식별자로 구성할 경우 너무 많은 속성 X 

-> 너무 많으면 인조 식별자 생성

## 식별자 관계

### 주 식별자 

자식의 주 식별자로 부모의 주 식별자 상속 

부모로부터 받은 식별자를 자식 엔터티의 주 식별자로 이용하는 경우

강한 연결 관계 표현, 실선 표기

식별자 관계로만 설정 시 주 식별자 증가로 오류 유발

### 비 식별자

부모 속성을 자식의 일반 속성으로 사용

1. 부모 없는 자식이 생성될 수 있는 경우

2. 부모와 자식의 생명 주기가 다른 경우 (별도로 소멸)

3. 여러개의 엔터티가 하나의 엔터티로 통합되어 표현되었는데 각각의 엔터티가 별도의 관계를 가진 경우

4. 자식 엔터티에 별도의 주 식별자를 생성하는 것이 더 유리한 경우

5. SQL 문장이 길어져 복잡성 증가되는 것 방지

약한 연결 관계 표현, 점선 표기

비 식별자 관계로만 설정 시 부모 엔터티와 조인하여 성능 저하


# 데이터 모델과 성능

## 성능 데이터 모델링

DB 성능 향상을 목적으로 데이터 모델링 때부터 정규화, 반정규화, 테이블 통합, 테이블 분할, 조인구조, PK, FK 등 여러가지 성능과 관련된 사항이 데이터 모델링에 반영될 수 있도록 하는 것

분석/ 설계 단계에서 데이터 모델에 성능을 고려한 데이터 모델링을 수행할 경우 성능 저하에 따른 재업무 비용을 최소화 할 수 있음

데이터의 증가가 빠를수록 성능 저하에 따른 성능 개선 비용은 기하급수적으로 증가하게 된다

### 성능 데이터 모델링 고려사항 순서

1. 데이터 모델링을 할때 정규화를 정확하게 수행

2. DB 용량 산정을 수행

3. DB에 발생되는 트랜잭션의 유형을 파악

4. 용량과 트랜잭션의 유형에 따라 반정규화를 수행

5. 이력모델의 조정, PK/FK 조정, 슈퍼/서브타입 조정

6. 성능 관점에서 데이터 모델을 검증


## 함수적 종속성

데이터들이 어떤 기준 값에 의해 종속되는 현상

## 정규화 (-)

반복적인 데이터를 분리하고 각 데이터가 종속된 테이블에 적절하게 배치되도록 하는 것

- 1차 정규화 = 같은 성격, 내용 컬럼이 연속될때 컬럼 제거, 테이블 생성

- 2차 정규화 = PK 복합 키 구성일때 부분적 함수 종속 관계 테이블 분리

- 3차 정규화 = PK가 아닌 일반 컬럼에 의존하는 컬럼 분리

## 반 정규화 (+)

정규화된 엔티티 ,속성, 관계에 대해 시스템의 성능 향상과 개발과 운영의 단순화를 위해 중복, 통합, 분리 등을 수행하는 데이터 모델링의 기법

조회시 디스크 I/O가 많거나 경로가 멀어 조인에 의한 성능 저하를 막기 위해 수행

일반적으로 정규화시 입력 / 수정 / 삭제 성능이 향상되며 반 정규화시 조인 성능이 향상

## 반 정규화 절차

1. 반 정규화 대상 조사 

(범위 처리 빈도 수 , 범위 , 통계성)

- 자주 사용되는 테이블에 접근하는 프로세스의 수가 많고 항상 일정한 범위만을 조회하는 경우
- 테이블에 대량의 데이터가 있고 대량의 데이터 범위를 자주 처리하는 경우에 처리 범위를 일정하게 줄이지 않으면 성능을 보장할 수 없는 경우

- 통계성 프로세스에 대해 통계 정보를 필요로할 때 별도의 통계테이블을 생성

- 테이블에 지나치게 많은 조인이 걸려 데이터를 조회하는 작업이 기술적으로 어려울 경우

2. 다른 방법 유도 검토 

( 뷰 , 클러스터링, 인덱스 조절 )

- view 사용

지나치게 많은 조인이 걸려 데이터를 조회하는 작업이 기술적으로 어려울 경우 view를 사용 ( view가 성능 향상 X)

- 클러스터링

대량의 데이터 처리나 부분 처리에 의해 성능이 저하되는 경우 클러스터링을 적용하거나 인덱스를 조정함 ( 조회가 대부분일때 클러스터링 적용 )

- 파티셔닝

대량의 데이터는 pk의 성격에 따라 부분적인 테이블로 분리할 수 있다. 파티셔닝 키에 의해 물리적 저장 공간 분리

- 캐시

응용 어플리케이션에서 로직을 구사하는 방법을 변경함으로써 성능을 향상

